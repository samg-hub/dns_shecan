# سناریوهای تست جامع برای Shecan DNS (macOS)

این سند شامل تمامی حالت‌های ممکن است که می‌تواند در عملکرد تغییر DNS اختلال ایجاد کند. پیشنهاد می‌شود تک‌تک این موارد را تست کنید تا از پایداری برنامه اطمینان حاصل شود.

---

## ۱. تداخل شبکه و اینترنت (Network Conflicts)

### سناریو ۱: اتصال همزمان VPN
*   **تست**: یک VPN (مثل Cisco AnyConnect، OpenVPN یا WireGuard) را روشن کنید.
*   **اقدام**: دکمه Connect را در برنامه بزنید.
*   **انتظار**:
    *   برنامه نباید کرش کند.
    *   *حالت ایده‌آل*: برنامه باید تشخیص دهد که VPN روشن است و ممکن است DNS تغییر نکند (چون VPN معمولاً DNS را قفل می‌کند).
    *   *بررسی*: سایت `check.shecan.ir` را باز کنید تا ببینید آیا شکن فعال شده است یا خیر.

### سناریو ۲: تغییر ناگهانی شبکه (Wi-Fi به کابل LAN)
*   **تست**: در حالی که برنامه "Connect" است، Wi-Fi را خاموش کرده و کابل شبکه (Wi-Fi) را وصل کنید (یا بالعکس).
*   **انتظار**: برنامه باید بتواند این تغییر را مدیریت کند یا حداقل وقتی دوباره دکمه را می‌زنید، روی کارت شبکه جدید اعمال شود.
*   **نکته**: آیا DNS روی کارت شبکه جدید هم ست شد؟

### سناریو ۳: قطع کامل اینترنت
*   **تست**: اتصال اینترنت را کاملاً قطع کنید (مثلاً مودم را خاموش کنید ولی Wi-Fi متصل باشد).
*   **اقدام**: دکمه Connect/Disconnect را بزنید.
*   **انتظار**: برنامه نباید هنگ کند. باید پیام خطا یا وضعیت مناسب نشان دهد.

---

## ۲. تداخل با تنظیمات سیستم (System Conflicts)

### سناریو ۴: تنظیمات دستی قبلی (Manual DNS)
*   **تست**: قبل از باز کردن برنامه، به `System Settings -> Network` بروید و دستی یک DNS عجیب (مثلاً `1.1.1.1`) ست کنید.
*   **اقدام**: برنامه را باز کنید و Connect بزنید. سپس Disconnect بزنید.
*   **انتظار**: بعد از Disconnect، باید تنظیمات DNS شما به همان `1.1.1.1` برگردد (نه حالت خالی/Automatic).

### سناریو ۵: پروفایل‌های سازمانی (MDM Profiles)
*   **تست**: اگر مک شما متعلق به شرکت است و پروفایل محدودیت شبکه دارد.
*   **اقدام**: تلاش برای تغییر DNS.
*   **انتظار**: اگر سیستم اجازه تغییر ندهد، برنامه باید خطای مناسب ("Permission Denied" یا مشابه) نشان دهد و سبز نشود.

### سناریو ۶: فعال بودن IPv6
*   **تست**: به شبکه‌ای وصل شوید که IPv6 فعال دارد.
*   **انتظار**: گاهی اوقات حتی با ست کردن DNS نسخه 4 (IPv4)، ترافیک از طریق IPv6 رد می‌شود و شکن کار نمی‌کند.
*   **بررسی**: آیا سایت‌ها باز می‌شوند؟

---

## ۳. سناریوهای امنیتی و دسترسی (Security)

### سناریو ۷: کنسل کردن دیا لوگ پسورد
*   **تست**: وقتی برای اولین بار دکمه Connect را می‌زنید و سیستم پسورد می‌خواهد، دکمه **Cancel** را بزنید.
*   **انتظار**: دکمه برنامه نباید سبز شود. باید به حالت Disconnected برگردد.

### سناریو ۸: تغییر پسورد سیستم
*   **تست**: پسورد ورود به مک خود را عوض کنید.
*   **اقدام**: برنامه را باز کنید و Connect بزنید.
*   **انتظار**: برنامه که پسورد قبلی را ذخیره کرده، با خطا مواجه می‌شود. باید مجدداً دیالوگ درخواست پسورد جدید را نمایش دهد.

---

## ۴. رابط کاربری و عملکرد (UI/UX)

### سناریو ۹: کلیک‌های رگباری (Race Condition)
*   **تست**: روی دکمه Connect/Disconnect خیلی سریع و پشت سر هم کلیک کنید.
*   **انتظار**: وضعیت برنامه نباید قاطی کند (مثلاً نوشته باشد Connected ولی آیکون قرمز باشد). باید درخواست‌ها را مدیریت کند یا دکمه را موقت غیرفعال کند.

### سناریو ۱۰: بستن برنامه در حالت متصل
*   **تست**: وقتی برنامه Connected است، آن را کامل ببندید (Quit).
*   **انتظار**: DNSهای سیستم باید همچنان ست باقی بمانند (چون تغییر سیستمی است).
### سناریو ۱۱: هشدار فعال بودن VPN
*   **تست**: یک VPN را روشن کنید.
*   **اقدام**: دکمه Connect را بزنید.
*   **انتظار**:
    *   یک دیالوگ باز شود: *"A VPN connection is active"*.
    *   اگر **Cancel** بزنید، اتصال انجام نشود.
    *   اگر **Proceed** بزنید، اتصال انجام شود (Force Connect).
    *   *بررسی*: DNS روی کارت شبکه فیزیکی (Wi-Fi) ست شده باشد.
